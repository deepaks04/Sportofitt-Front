<!-- start: PAGE TITLE -->
<section id="page-title">
    <div class="row">
        <div class="col-sm-8">
            <h1 class="mainTitle">VENUE LIST</h1>
            <span class="mainDescription">List of available venue for
                your business</span>
        </div>
        <div ncy-breadcrumb></div>
    </div>
</section>
<!-- end: PAGE TITLE -->


<!-- start: FACILITY LIST WITH SORTING -->
<div class="container-fluid container-fullw bg-white">
    <script type="text/ng-template" id="sessionPackageModal.html">
        <div class="modal-header">
            <h3 class="modal-title">Session/Packages for {{facility.name}}</h3>
        </div>
        <div class="modal-body">
            <tabset>
                <tab heading="Opening Hours" ng-click="getOpeningHours()" active="tab === 'opening_hours'">
                    <table class="table table-bordered table-hover table-condensed">
                        <tr style="font-weight: bold">
                            <td style="width:20%">Day</td>
                            <td style="width:20%">Start Time</td>
                            <td style="width:20%">End Time</td>
                            <td style="width:15%">Pick Hour</td>
                            <td style="width:20%">Edit</td>
                        </tr>
                        <tr ng-repeat="time in openingHours">
                            <td>
        <span e-name="id" e-form="editHoursForm" editable-hidden="time.id">
        </span>
<span editable-select="time.day" e-name="day" e-form="editHoursForm" e-ng-options="s.id as s.name for s in days"
      e-required>
          {{ showDay(time) }}
        </span>
    <span class="has-error" ng-if="editHoursForm.$dirty && hoursErrors.day"><label
            class="help-block">{{hoursErrors.day}}</label></span>

                            </td>
                            <td>
        <span e-name="start" e-form="editHoursForm" editable-bstime="time.start" e-show-meridian="true"
              e-minute-step="1"
              e-required>
        {{ (time.start | date:"hh:mm a")  }}
        </span>
 <span class="has-error" ng-if="editHoursForm.$dirty && hoursErrors.start"><label
         class="help-block">{{hoursErrors.start}}</label></span>
                            </td>
                            <td>
        <span editable-bstime="time.end" e-show-meridian="true" e-name="end" e-form="editHoursForm" e-minute-step="1"
              e-required>
        {{ (time.end | date:"hh:mm a")  }}
        </span>
 <span class="has-error" ng-if="editHoursForm.$dirty && hoursErrors.end"><label
         class="help-block">{{hoursErrors.end}}</label></span>
                            </td>
                            <td>
                                <span editable-checkbox="time.is_peak" e-name="is_peak" e-form="editHoursForm"
                                      e-title="Peak Hour?" e-ng-true-value="1" e-ng-false-value="0">
                                    {{ (time.is_peak == "1")?"Peak Hour":"Off Peak Hour" }}
                                    </span>
                            </td>
                            <td style="white-space: nowrap">
                                <!-- form -->
                                <form editable-form name="editHoursForm"
                                      onbeforesave="saveHours($data, time.id,editHoursForm)"
                                      ng-show="editHoursForm.$visible || editHoursForm.$waiting"
                                      class="form-buttons form-inline"
                                      shown="inserted == time">
                                    <button type="submit" ng-disabled="editHoursForm.$waiting" class="btn btn-primary">
                                        save
                                    </button>
                                    <button type="button" ng-disabled="editHoursForm.$waiting" ng-if="!time.id"
                                            ng-click="removeOpeningHours($index,time.id)"
                                            class="btn btn-default">
                                        cancel
                                    </button>
                                    <button type="button" ng-disabled="editHoursForm.$waiting" ng-if="time.id"
                                            ng-click="editHoursForm.$hide()"
                                            class="btn btn-default">
                                        cancel
                                    </button>
                                </form>
                                <div class="buttons" ng-show="!editHoursForm.$visible">
                                    <button class="btn btn-primary" ng-click="editHoursForm.$show()">edit</button>
                                    <button class="btn btn-danger" ng-click="removeOpeningHours($index,time.id)">del
                                    </button>
                                </div>
                            </td>
                        </tr>

                    </table>
                    <button class="btn btn-default" ng-click="addHours()">Add Time</button>
                </tab>
                <tab heading="Sessions" ng-click="getSessions()" active="tab === 'sessions'">
                    <table class="table table-bordered table-hover table-condensed">
                        <tr style="font-weight: bold">
                            <!--	<td style="width:25%">Name</td> -->
                            <td style="width:15%">No of Peak Time</td>
                            <td style="width:15%">No of Off peak Time</td>
                            <td style="width:15%">Actual Price</td>
                            <td style="width:25%">Discount</td>
                            <td style="width:10%">Discounted Price</td>
                    <td style="width:28%">Actions</td>
                        </tr>
                        <tr ng-repeat="session in sessions">
                            <!--<td>
                            <span e-name="name" e-form="rowform" editable-text="session.name">
                            {{ session.name  }}
                            </span>
                            </td>-->
                            <td>
        <span e-name="peak" e-form="rowform" editable-number="session.peak" e-min="0" e-max="10" e-ng-click="calculateSessionPricing(rowform.$data,session)" e-ng-change="calculateSessionPricing(rowform.$data,session)">
        {{ session.peak  }}
        </span>
                                <span class="has-error" ng-if="rowform.$dirty && errors.peak"><label
                                        class="help-block">{{errors.peak}}</label></span>
                            </td>
                            <td>
        <span e-name="off_peak" e-form="rowform" editable-number="session.off_peak" e-min="0" e-max="10" e-ng-click="calculateSessionPricing(rowform.$data,session)" e-ng-change="calculateSessionPricing(rowform.$data,session)">
        {{ session.off_peak  }}
        </span>
                                <span class="has-error" ng-if="rowform.$dirty && errors.off_peak"><label
                                        class="help-block">{{errors.off_peak}}</label></span>
                            </td>
                            <td>
        <span e-name="price" e-form="rowform" editable-text="session.price" e-readonly>
        {{ session.price  }}
        </span>
                                <span class="has-error" ng-if="rowform.$dirty && errors.price"><label
                                        class="help-block">{{errors.price}}</label></span>
                            </td>
                            <td>
        <span e-name="discount" e-form="rowform" editable-range="session.discount" e-min="0" e-max="100" e-step="1"
              e-style="width:90%">
        {{ session.discount  }}
        </span>
                                <span class="has-error" ng-if="rowform.$dirty && errors.discount"><label
                                        class="help-block">{{errors.discount}}</label></span>
                            </td>
                            <td>
        <span  e-form="rowform" e-style="width:90%">
        {{ session.price - ((session.price*session.discount)/100)  }}
        </span>
                                <span class="has-error" ng-if="rowform.$dirty && errors.discount"><label
                                        class="help-block">{{errors.discount}}</label></span>
</td>
                            <td>
                                <!-- form -->
                                <form editable-form name="rowform" onbeforesave="saveSession($data, session.id,rowform)"
                                      ng-show="rowform.$visible || rowform.$waiting" class="form-buttons form-inline "
                                      shown="showSessionEdit" novalidate>
                     <div class="buttons pull-right">
            <button type="submit" ng-disabled="rowform.$waiting" class="btn btn-primary">
                                        save
                                    </button>
                                    <button type="button" ng-disabled="rowform.$waiting" ng-if="!session.id"
                                            ng-click="removeSession($index,session.id)"
                                            class="btn btn-default">
                                        cancel
                                    </button>
                                    <button type="button" ng-disabled="rowform.$waiting" ng-if="session.id"
                                            ng-click="rowform.$hide()"
                                            class="btn btn-default">
                                        cancel
                                    </button>
                            </div>
                                </form>
                                <div class="buttons pull-right" ng-show="!rowform.$visible">
                                    <button class="btn btn-primary" ng-click="rowform.$show()">edit</button>
                                    <button class="btn btn-danger" ng-click="removeSession($index,session.id)">del
                                    </button>
                                </div>
                            </td>
                        </tr>

                    </table>
                    <button class="btn btn-default" ng-click="addSession()">Add Session</button>
                </tab>

                <tab heading="Packages" ng-click="getPackages()" active="tab === 'packages'">
                    <table class="table table-bordered table-hover table-condensed">
                        <tr style="font-weight: bold">
                            <td style="width:25%">Name</td>
                            <td style="width:15%">Months</td>
                            <td style="width:20%">Actual Price</td>
                            <td style="width:15%">Pick Package</td>
                            <td style="width:25%">Discount</td>
                            <td style="width:25%">Description</td>

                            <td style="width:25%">Action</td>

                        </tr>
                        <tr ng-repeat="package in packages">
                            <td>
        <span e-name="name" e-form="rowform" editable-text="package.name">
        {{ package.name  }}
        </span>
                                 <span class="has-error" ng-if="rowform.$dirty && errors.name"><label
                                         class="help-block">{{errors.name}}</label></span>
                            </td>
                            <td>
        <span e-name="month" e-form="rowform" editable-number="package.month" e-min="1" e-max="12">
        {{ package.month  }}
        </span>
                                 <span class="has-error" ng-if="rowform.$dirty && errors.month"><label
                                         class="help-block">{{errors.month}}</label></span>
                            </td>
                            <td>
        <span e-name="actual_price" e-form="rowform" editable-text="package.actual_price">
        {{ package.actual_price  }}
        </span>
                                 <span class="has-error" ng-if="rowform.$dirty && errors.actual_price"><label
                                         class="help-block">{{errors.actual_price}}</label></span>
                            </td>
                            <td>
                                <sapn editable-checkbox="package.is_peak" e-name="is_peak" e-form="rowform"
                                      e-title="Peak Hour?" e-ng-true-value="1" e-ng-false-value="0">
                                    {{ (package.is_peak)?"Peak Hour":"Off Peak Hour" }}
                                    </span>
                                     <span class="has-error" ng-if="rowform.$dirty && errors.is_peak"><label
                                             class="help-block">{{errors.is_peak}}</label></span>
                            </td>
                            <td>
        <span e-name="discount" e-form="rowform" editable-range="package.discount" e-min="0" e-max="100" e-step="5"
              e-style="width:88%">
        {{ package.discount }}
        </span>
                                 <span class="has-error" ng-if="rowform.$dirty && errors.discount"><label
                                         class="help-block">{{errors.discount}}</label></span>
                            </td>
                            <td>
        <span e-name="description" e-form="rowform" editable-textarea="package.description">
        {{ package.description || 'No description' }}
        </span>
                                 <span class="has-error" ng-if="rowform.$dirty && errors.description"><label
                                         class="help-block">{{errors.description}}</label></span>
                            </td>
                            <td style="white-space: nowrap">
                                <!-- form -->
                                <form editable-form name="rowform" onbeforesave="savePackage($data, package.id,rowform)"
                                      ng-show="rowform.$visible" class="form-buttons form-inline"
                                      shown="packageInserted == package">
                                    <button type="submit" ng-disabled="rowform.$waiting" class="btn btn-primary btn-xs">
                                        save
                                    </button>
                                    <button type="button" ng-disabled="rowform.$waiting" ng-if="!package.id"
                                            ng-click="removePackage($index,package.id)"
                                            class="btn btn-default btn-xs">cancel
                                    </button>
                                  <button type="button" ng-disabled="rowform.$waiting" ng-if="package.id"
                                            ng-click="rowform.$hide()"
                                            class="btn btn-default btn-xs">
                                        cancel
                                    </button>
                                </form>
                                <div class="buttons" ng-show="!rowform.$visible">
                                    <button class="btn btn-primary btn-xs" ng-click="rowform.$show()">edit</button>
                                    <button class="btn btn-danger btn-xs" ng-click="removePackage($index,package.id)">
                                        del
                                    </button>
                                </div>
                            </td>
                        </tr>

                    </table>
                    <button class="btn btn-default" ng-click="addPackage()">Add Package</button>
                </tab>
                <tab heading="Edit Facility" ng-click="setTab('edit')" active="tab === 'edit'">
                      <form name="Form" id="form1" novalidate
                      ng-submit="update(Form)" enctype="multipart/form-data">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group"
                                 ng-class="{'has-error':Form.name.$dirty && Form.name.$invalid, 'has-success':Form.name.$valid}">
                                <label class="control-label"> Name <span
                                        class="symbol required"></span>
                                </label> <input type="text" placeholder="Enter Venue Name"
                                                class="form-control" name="name" ng-model="facility.name"
                                                required/> <span class="error text-small block"
                                                ng-if="Form.name.$dirty && Form.name.$invalid">
                                    {{Form.name.$error[0]}}
                                </span>
                            </div>
                            <div class="form-group"
                                 ng-class="{'has-error':Form.root_category_id.$dirty && Form.root_category_id.$invalid, 'has-success':Form.root_category_id.$valid}">
                                <label class="control-label"> Root Category <span
                                        class="symbol required"></span>
                                </label> <select class="form-control" name="root_category_id"
                                                 ng-model="selectedCategory"
                                                 ng-options="cat.sub_category as cat.name for cat in categoryData"
                                                 required>
                                    <option value="">Select Category</option>
                                </select> <span class="error text-small block"
                                                ng-if="Form.root_category_id.$dirty && Form.root_category_id.$invalid">
                                    {{Form.root_category_id.$error[0]}}</span>
                            </div>
                            <div class="form-group"
                                 ng-class="{'has-error':Form.sub_category_id.$dirty && Form.sub_category_id.$invalid, 'has-success':Form.sub_category_id.$valid}">
                                <label class="control-label"> Sub Category <span
                                        class="symbol required"></span>
                                </label> <select name="sub_category_id" class=" form-control"
                                                 name="facility.sub_category_id"
                                                 ng-model="facility.sub_category_id"
                                                 ng-options="cat.id as cat.name for cat in selectedCategory"
                                                 ng-disabled="!selectedCategory.length" required>
                                    <option value="">Select Category</option>
                                </select> <span class="error text-small block"
                                                ng-if="Form.sub_category_id.$dirty && Form.sub_category_id.$invalid">{{Form.sub_category_id.$error[0]}}</span>
                            </div>
                            <div class="form-group"
                                 ng-class="{'has-error':Form.duration.$dirty && Form.duration.$invalid, 'has-success':Form.duration.$valid}">
                                <label class="control-label"> Session Duration <span
                                        class="symbol required"></span>
                                </label>
                                <select class="form-control" name="duration" ng-model="facility.duration"
                                        ng-options="duration.actual_time as duration.time for duration in durations"
                                        required>
                                    <option value="">Select Duration</option>
                                </select>
                                <span class="error text-small block"
                                      ng-if="Form.duration.$dirty && Form.duration.$invalid">{{Form.duration.$error[0]}}</span>
                            </div>
                            <div class="form-group"
                                 ng-class="{'has-error':Form.slots.$dirty && Form.slots.$invalid, 'has-success':Form.slots.$valid}">
                                <label class="control-label"> Slots <span
                                        class="symbol required"></span>
                                </label> <input type="text" class="form-control" name="slots"
                                                ng-model="facility.slots"
                                                required>
                                <span class="error text-small block"
                                      ng-if="Form.slots.$dirty && Form.slots.$invalid">{{Form.slots.$error[0]}}</span>
                            </div>
                        </div>

                        <div class="col-md-6">
                            <div class="form-group"
                                 ng-class="{'has-error':Form.peak_hour_price.$dirty && Form.peak_hour_price.$invalid,
                                                                        'has-success':Form.peak_hour_price.$valid}">
                                <label class="control-label"> Peak Pricing<span
                                        class="symbol required"></span>
                                </label>
                                <input type="text"  class="form-control"
                                       name="peak_hour_price" ng-model="facility.peak_hour_price"
                                       required>
                                <span class="error text-small block"
                                      ng-if="Form.peak_hour_price.$dirty && Form.peak_hour_price.$invalid">{{Form.peak_hour_price.$error[0]}}</span>
                            </div>
                            <div class="form-group"
                                 ng-class="{'has-error':Form.off_peak_hour_price.$dirty && Form.off_peak_hour_price.$invalid,
                                                                        'has-success':Form.off_peak_hour_price.$valid}">
                                <label class="control-label"> Off Peak Pricing<span
                                        class="symbol required"></span>
                                </label>
                                <input type="text" class="form-control"
                                       name="off_peak_hour_price" ng-model="facility.off_peak_hour_price"
                                       required>
                                <span class="error text-small block"
                                      ng-if="Form.off_peak_hour_price.$dirty && Form.off_peak_hour_price.$invalid">{{Form.off_peak_hour_price.$error[0]}}</span>
                            </div>
                            <div class="form-group"
                                 ng-class="{'has-error':Form.cancellation_before_24hrs.$dirty && Form.cancellation_before_24hrs.$invalid,
                                                                        'has-success':Form.cancellation_before_24hrs.$valid}">
                                <label class="control-label"> Cancellation before 24 hours (%) <span
                                        class="symbol required"></span>
                                </label>
                                <input type="text"  class="form-control"
                                       name="cancellation_before_24hrs" ng-model="facility.cancellation_before_24hrs"
                                       required>
                                <span class="error text-small block"
                                      ng-if="Form.cancellation_before_24hrs.$dirty && Form.cancellation_before_24hrs.$invalid">{{Form.cancellation_before_24hrs.$error[0]}}</span>
                            </div>
                            <div class="form-group"
                                 ng-class="{'has-error':Form.cancellation_after_24hrs.$dirty && Form.cancellation_after_24hrs.$invalid, 'has-success':Form.cancellation_after_24hrs.$valid}">
                                <label class="control-label"> Cancellation within 24 hours (%)<span
                                        class="symbol required"></span>
                                </label>
                                <input type="text" class="form-control" min="0" name="cancellation_after_24hrs"
                                       ng-model="facility.cancellation_after_24hrs"
                                       required>
                                <span class="error text-small block"
                                      ng-if="Form.cancellation_after_24hrs.$dirty && Form.cancellation_after_24hrs.$invalid">{{Form.cancellation_after_24hrs.$error[0]}}</span>
                            </div>
                            <div class="form-group"
                                 ng-class="{'has-error':Form.description.$dirty && Form.description.$invalid, 'has-success':Form.description.$valid}">
                                <label class="control-label"> Description
                                </label>
                                <textarea name="description" class="form-control"
                                          data-ng-model="facility.description"></textarea>
                                <span class="error text-small block"
                                      ng-if="Form.description.$dirty && Form.description.$invalid">{{Form.description.$error[0]}}</span>
                            </div>

                            <div class="form-actions">
                                <button type="submit" class="btn btn-primary pull-right">
                                    Submit <i class="fa fa-arrow-circle-right"></i>
                                </button>
                            </div>
                        </div>
                    </div>


                </form>
                </tab>
                <tab heading="Add Images" ng-click="getVendorImages()" active="tab === 'images'">
                      <form name="Form" id="form1" novalidate
                      ng-submit="update(Form)" enctype="multipart/form-data">
                    <div class="row">
                            <div nv-file-drop="" uploader="uploaderImages">
                                <div class="col-md-3">
							<h5>Select files</h5>
							<div class="panel panel-white">
								<div class="panel-body">
									<div ng-show="uploaderImages.isHTML5">
										<!-- 3. nv-file-over uploader="link" over-class="className" -->
										<div class="well my-drop-zone" nv-file-over=""
											uploader="uploaderImages">Drag n Drop your images here
											</div>
										
									</div>
									<!-- Example: nv-file-select="" uploader="{Object}" options="{Object}" filters="{String}" -->
									<span class="btn btn-primary btn-o btn-file"> Select an
										image file <input type="file" nv-file-select=""
										uploader="uploaderImages" multiple />
									</span> <br />
								</div>
							</div>
						</div>
                                    <div class="col-md-9 file-upload" style="margin-bottom: 40px">
							<h4>Uploded Images</h4>
							<p>Queue length: {{ images.length }}</p>
							<div class="table-responsive">
								<table class="table">
									<thead>
										<tr>
											<th width="50%">Name</th>
											<th>Actions</th>
										</tr>
									</thead>
									<tbody>
                                                                            
										<tr ng-if="images.length" ng-repeat="image in images">
											<td><strong></strong> <!-- Image preview --> <!--auto height-->
												<!--<div ng-thumb="{ file: item.file, width: 100 }"></div>-->
												<!--auto width--> <img ng-src="{{image.image_name}}"
												width="100"> <!--fixed width and height --> <!--<div ng-thumb="{ file: item.file, width: 100, height: 100 }"></div>-->
											</td>
											<td nowrap>
												<button type="button" class="btn btn-danger btn-xs"
													ng-click="removeImage(image.id)">
													<span class="glyphicon glyphicon-trash"></span> Remove
												</button>
											</td>
										</tr>
                                                                                <p ng-if="!images.length">{{imagesReponse}}</p>
									</tbody>
								</table>
							</div>
						</div>
                            </div>
                        </div>


                </form>
                </tab>
            </tabset>
        </div>
        <div class="modal-footer">
            <button class="btn btn-primary" ng-click="cancel()">Close</button>
        </div>
    </script>

    <div class="row">
        <div class="col-md-12">
            <h5 class="over-title margin-bottom-15">
                <span class="text-bold">VENUE</span>
            </h5>
            <!-- /// controller:  'ngTableCtrl2' -  localtion: assets/js/controllers/ngTableCtrl.js /// -->
            <div ng-controller="facilityListCtrl">
                <div class="row margin-bottom-10">
                    <div class="col-md-12">
                        <button ui-sref="vendor.facility.add"
                                class="btn btn-default pull-right">Add New Venue
                        </button>
                    </div>
                </div>
                <table ng-table="tableParams" class="table table-striped">
                    <tr ng-repeat="facility in facilityData" ng-if="facility.is_active">
                        <td data-title="'Name'" sortable="'name'"><a
                                data-ng-click="open('lg', facility, 'edit', false)">{{facility.name}}</a></td>
                        <td class="center" data-title="'Category'">{{facility.category.sub.name}}</td>
                        <td data-title="'Slots'" sortable="'slots'">{{facility.slots}}</td>
                        <td data-title="'Created At'" sortable="'created_at'">{{facility.created_at}}</td>
                        <td class="center">
                            <div class="visible-md visible-lg hidden-sm hidden-xs">
                                <a data-ng-click="open('lg', facility, 'opening_hours', true)"
                                   class="btn btn-transparent btn-xs" tooltip-placement="top"
                                   tooltip="Add"><i class="fa fa-plus"></i></a>
                                <a data-ng-click="open('lg', facility, 'edit', false)"
                                   class="btn btn-transparent btn-xs" tooltip-placement="top"
                                   tooltip="Edit Venue"><i class="fa fa-pencil"></i></a>
                                <!--<a ng-if="facility.is_active" data-ng-click="blockUnblockFacility(facility)"-->
                                <!--class="btn btn-transparent btn-xs" tooltip-placement="top"-->
                                <!--tooltip="Block facility"><i class="fa fa-toggle-off"></i></a>-->
                                <a data-ng-click="blockUnblockFacility(facility)"
                                   class="btn btn-transparent  btn-xs" tooltip-placement="top"
                                   tooltip="Delete Venue"><i class=" danger fa fa-remove"></i></a>
                                <a
                                    ui-sref="vendor.facility.calender({facilityId : facility.id})"
                                    class="btn btn-transparent btn-xs tooltips"
                                    tooltip-placement="top" tooltip="Calender"><i class="fa fa-calendar"></i>
                                </a>
                            </div>
                            <div class="visible-xs visible-sm hidden-md hidden-lg">
                                <div class="btn-group" dropdown is-open="status.isopen">
                                    <button type="button"
                                            class="btn btn-primary btn-o btn-sm dropdown-toggle"
                                            dropdown-toggle>
                                        <i class="fa fa-cog"></i>&nbsp;<span class="caret"></span>
                                    </button>
                                    <ul class="dropdown-menu pull-right dropdown-light" role="menu">
                                        <li><a data-ng-click="open('lg', facility, 'opening_hours', true)"> Add </a>
                                        </li>
                                        <li><a data-ng-click="open('lg', facility, 'edit', false)"> Edit </a></li>
                                        <li><a data-ng-click="blockUnblockFacility(facility)"> Delete </a></li>
                                        <li><a
                                                ui-sref="vendor.facility.booking({facilityId : facility.id})">
                                                Book </a></li>
                                    </ul>
                                </div>
                            </div>
                        </td>
                    </tr>
                </table>
            </div>
        </div>
    </div>
</div>
<!-- end: TABLE WITH SORTING -->